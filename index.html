<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eco Sorting Battle - Firebase Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap');
        body { font-family: 'Kanit', sans-serif; }
        .btn-hover:active { transform: scale(0.95); }
        .update-flash { animation: flash 0.5s ease-out; }
        @keyframes flash {
            0% { background-color: rgba(16, 185, 129, 0.2); }
            100% { background-color: transparent; }
        }
        .screen { display: none; }
        .screen.active { display: block; }
    </style>
</head>
<body class="bg-emerald-50 min-h-screen flex flex-col items-center p-4">

    <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏Ç‡∏≠‡∏á‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå -->
    <header class="text-center my-6">
        <h1 class="text-4xl font-bold text-emerald-800 flex items-center justify-center gap-2">
            üå± Eco Sorting Battle
        </h1>
        <p class="text-emerald-600 mt-2 text-sm md:text-base italic">‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Firebase ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</p>
    </header>

    <!-- ‡∏Ñ‡∏≠‡∏ô‡πÄ‡∏ó‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å -->
    <main class="w-full max-w-md bg-white rounded-3xl shadow-xl overflow-hidden p-6 relative border-b-8 border-emerald-200">
        
        <!-- 1. ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (Login Screen) -->
        <div id="login-screen" class="screen active space-y-6">
            <div class="text-center">
                <div class="text-6xl mb-4">‚ôªÔ∏è</div>
                <h2 class="text-2xl font-semibold text-gray-800">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö</h2>
                <p class="text-gray-500">‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</p>
            </div>
            <input type="text" id="player-name" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì..." 
                class="w-full px-4 py-3 border-2 border-emerald-100 rounded-xl focus:border-emerald-500 outline-none text-lg">
            <button id="btn-start"
                class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 rounded-xl text-xl shadow-lg btn-hover transition-all">
                ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÄ‡∏Å‡∏°
            </button>
            
            <div class="mt-8 border-t pt-4">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="font-bold text-emerald-800">üèÜ ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ</h3>
                    <span id="status-tag" class="flex items-center gap-1 text-[10px] text-gray-400 font-bold uppercase tracking-wider">
                        <span id="status-dot" class="w-2 h-2 bg-gray-400 rounded-full"></span> 
                        <span id="status-text">Connecting</span>
                    </span>
                </div>
                <div id="leaderboard-login" class="space-y-2">
                    <p class="text-center text-gray-400 text-sm italic">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>
            </div>
        </div>

        <!-- 2. ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡πÄ‡∏•‡πà‡∏ô‡πÄ‡∏Å‡∏° (Game Screen) -->
        <div id="game-screen" class="screen space-y-6">
            <div class="flex justify-between items-center bg-emerald-100 p-3 rounded-2xl border border-emerald-200">
                <div class="text-lg font-bold text-emerald-800">‚è±Ô∏è <span id="timer">60</span> s</div>
                <div class="text-lg font-bold text-emerald-800">‚≠êÔ∏è ‡πÅ‡∏ï‡πâ‡∏°: <span id="score">0</span></div>
            </div>

            <div id="item-container" class="py-12 px-4 flex flex-col items-center justify-center bg-gray-50 rounded-2xl border-2 border-dashed border-emerald-200 text-center min-h-[220px]">
                <div id="item-emoji" class="text-7xl mb-4 animate-bounce">üì¶</div>
                <h2 id="item-name" class="text-3xl font-bold text-gray-800 leading-tight">...</h2>
            </div>

            <div class="grid grid-cols-2 gap-3">
                <button id="btn-recycle" class="bg-blue-500 text-white p-4 rounded-2xl font-bold btn-hover shadow-md">üîµ ‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏•</button>
                <button id="btn-organic" class="bg-green-500 text-white p-4 rounded-2xl font-bold btn-hover shadow-md">üü¢ ‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå</button>
                <button id="btn-hazard" class="bg-yellow-500 text-white p-4 rounded-2xl font-bold btn-hover shadow-md border-b-4 border-yellow-700">üü° ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢</button>
                <button id="btn-general" class="bg-gray-500 text-white p-4 rounded-2xl font-bold btn-hover shadow-md">‚ö´ ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</button>
            </div>
        </div>

        <!-- 3. ‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏• (Result Screen) -->
        <div id="result-screen" class="screen space-y-6">
            <div class="text-center py-4">
                <div class="text-6xl mb-4">üéñÔ∏è</div>
                <h2 class="text-3xl font-bold text-emerald-800">‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô!</h2>
                <div class="my-6 bg-emerald-50 py-4 rounded-2xl border-2 border-emerald-100">
                    <p class="text-gray-600 text-lg">‡∏Ñ‡∏∏‡∏ì <span id="res-name" class="font-bold text-emerald-700">...</span></p>
                    <p class="text-4xl font-black text-emerald-800 mt-2">‡πÑ‡∏î‡πâ <span id="res-score">0</span> ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
                </div>
            </div>

            <div class="space-y-3">
                <h3 class="font-bold text-emerald-800 flex items-center gap-2">
                    üèÜ ‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏ô‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå
                </h3>
                <div id="leaderboard-result" class="space-y-2 max-h-[200px] overflow-y-auto">
                    <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
            </div>

            <button onclick="location.reload()" 
                class="w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 rounded-xl text-xl shadow-lg btn-hover transition-all mt-4">
                ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            </button>
        </div>
    </main>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query } from "https://www.gstatic.com/firebasejs/11.0.2/firebase-firestore.js";

        // --- 1. ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Firebase ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì ---
        const firebaseConfig = {
            apiKey: "AIzaSyA5DmgQGt7shLyB-ni89tv8WEgx4Ikv_A4",
            authDomain: "my-education-app-56791.firebaseapp.com",
            projectId: "my-education-app-56791",
            storageBucket: "my-education-app-56791.firebasestorage.app",
            messagingSenderId: "784125477428",
            appId: "1:784125477428:web:51df7a5db8fda352114061",
            measurementId: "G-4E1P7E6WRJ"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);
        
        // ‡πÉ‡∏ä‡πâ projectId ‡πÄ‡∏õ‡πá‡∏ô appId ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Firestore ‡∏ï‡∏≤‡∏° Rule
        const appId = "my-education-app-56791";

        let currentUser = null;
        let score = 0;
        let timeLeft = 60;
        let currentItem = null;
        let timerInterval = null;
        let playerName = "";

        const items = [
            // ‡∏£‡∏µ‡πÑ‡∏ã‡πÄ‡∏Ñ‡∏¥‡∏• (üîµ recycle)
            { name: "‡∏Ç‡∏ß‡∏î‡∏ô‡πâ‡∏≥‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å", type: "recycle", emoji: "üß¥" },
            { name: "‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏≠‡∏±‡∏î‡∏•‡∏°", type: "recycle", emoji: "ü•§" },
            { name: "‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏Å‡πà‡∏≤", type: "recycle", emoji: "üì∞" },
            { name: "‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏•‡∏±‡∏á", type: "recycle", emoji: "üì¶" },
            { name: "‡∏Ç‡∏ß‡∏î‡πÅ‡∏Å‡πâ‡∏ß‡πÇ‡∏ã‡∏î‡∏≤", type: "recycle", emoji: "üçæ" },
            { name: "‡∏ô‡∏¥‡∏ï‡∏¢‡∏™‡∏≤‡∏£‡πÄ‡∏Å‡πà‡∏≤", type: "recycle", emoji: "üìö" },
            { name: "‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏≠‡∏•‡∏π‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°", type: "recycle", emoji: "ü•´" },
            { name: "‡∏Ç‡∏ß‡∏î‡πÅ‡∏ä‡∏°‡∏û‡∏π‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å", type: "recycle", emoji: "üßº" },

            // ‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå (üü¢ organic)
            { name: "‡πÄ‡∏®‡∏©‡∏ú‡∏±‡∏Å‡∏ú‡∏•‡πÑ‡∏°‡πâ", type: "organic", emoji: "ü•¨" },
            { name: "‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏Ç‡πà", type: "organic", emoji: "ü•ö" },
            { name: "‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡πâ‡∏ß‡∏¢", type: "organic", emoji: "üçå" },
            { name: "‡∏Å‡πâ‡∏≤‡∏á‡∏õ‡∏•‡∏≤", type: "organic", emoji: "üêü" },
            { name: "‡πÉ‡∏ö‡πÑ‡∏°‡πâ‡πÅ‡∏´‡πâ‡∏á", type: "organic", emoji: "üçÇ" },
            { name: "‡πÄ‡∏õ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡πâ‡∏°", type: "organic", emoji: "üçä" },
            { name: "‡πÄ‡∏®‡∏©‡∏Ç‡∏ô‡∏°‡∏õ‡∏±‡∏á", type: "organic", emoji: "üçû" },
            { name: "‡πÅ‡∏Å‡∏ô‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î", type: "organic", emoji: "üçç" },

            // ‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢ (üü° hazard)
            { name: "‡∏ñ‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏â‡∏≤‡∏¢", type: "hazard", emoji: "üîã" },
            { name: "‡∏´‡∏•‡∏≠‡∏î‡πÑ‡∏ü‡πÄ‡∏Å‡πà‡∏≤", type: "hazard", emoji: "üí°" },
            { name: "‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏™‡πÄ‡∏õ‡∏£‡∏¢‡πå", type: "hazard", emoji: "üí®" },
            { name: "‡∏¢‡∏≤‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏", type: "hazard", emoji: "üíä" },
            { name: "‡πÅ‡∏ö‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡∏µ‡πà‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠", type: "hazard", emoji: "üì±" },
            { name: "‡∏Ç‡∏ß‡∏î‡∏¢‡∏≤‡∏Ü‡πà‡∏≤‡πÅ‡∏°‡∏•‡∏á", type: "hazard", emoji: "üß™" },
            { name: "‡∏ï‡∏•‡∏±‡∏ö‡∏´‡∏°‡∏∂‡∏Å‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏û‡∏¥‡∏°‡∏û‡πå", type: "hazard", emoji: "üñ®Ô∏è" },
            { name: "‡∏Å‡∏£‡∏∞‡∏õ‡πã‡∏≠‡∏á‡∏™‡∏µ‡∏™‡πÄ‡∏õ‡∏£‡∏¢‡πå", type: "hazard", emoji: "üé®" },

            // ‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‚ö´ general)
            { name: "‡∏ã‡∏≠‡∏á‡∏Ç‡∏ô‡∏°", type: "general", emoji: "üçü" },
            { name: "‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÇ‡∏ü‡∏°‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô", type: "general", emoji: "üç±" },
            { name: "‡∏Å‡∏£‡∏∞‡∏î‡∏≤‡∏©‡∏ó‡∏¥‡∏ä‡∏ä‡∏π‡πà‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß", type: "general", emoji: "üßª" },
            { name: "‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏≤‡∏Å‡∏≠‡∏ô‡∏≤‡∏°‡∏±‡∏¢", type: "general", emoji: "üò∑" },
            { name: "‡∏´‡∏•‡∏≠‡∏î‡∏î‡∏π‡∏î‡∏ô‡πâ‡∏≥", type: "general", emoji: "ü•§" },
            { name: "‡∏ã‡∏≠‡∏á‡∏Å‡∏≤‡πÅ‡∏ü", type: "general", emoji: "‚òï" },
            { name: "‡∏ñ‡∏∏‡∏á‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å‡πÄ‡∏õ‡∏∑‡πâ‡∏≠‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£", type: "general", emoji: "üõçÔ∏è" },
            { name: "‡∏´‡∏ô‡∏±‡∏á‡∏¢‡∏≤‡∏á", type: "general", emoji: "‚û∞" }
        ];

        // ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠
        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(screenId).classList.add('active');
        }

        const startGame = () => {
            const name = document.getElementById('player-name').value.trim();
            if (!name) return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏•‡πà‡∏ô‡∏Ñ‡∏£‡∏±‡∏ö");
            playerName = name;
            showScreen('game-screen');
            score = 0;
            timeLeft = 60;
            document.getElementById('score').innerText = score;
            nextItem();
            startTimer();
        };

        function nextItem() {
            currentItem = items[Math.floor(Math.random() * items.length)];
            document.getElementById('item-name').innerText = currentItem.name;
            document.getElementById('item-emoji').innerText = currentItem.emoji;
        }

        const checkAnswer = (type) => {
            const container = document.getElementById('item-container');
            if (type === currentItem.type) {
                score += 10;
                flashEffect(container, 'bg-green-100');
            } else {
                score = Math.max(0, score - 5);
                flashEffect(container, 'bg-red-100');
            }
            document.getElementById('score').innerText = score;
            nextItem();
        };

        function flashEffect(el, colorClass) {
            el.classList.remove('bg-gray-50');
            el.classList.add(colorClass);
            setTimeout(() => {
                el.classList.remove(colorClass);
                el.classList.add('bg-gray-50');
            }, 200);
        }

        function startTimer() {
            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').innerText = timeLeft;
                if (timeLeft <= 0) endGame();
            }, 1000);
        }

        async function endGame() {
            clearInterval(timerInterval);
            document.getElementById('res-name').innerText = playerName;
            document.getElementById('res-score').innerText = score;
            showScreen('result-screen');
            
            if (currentUser) {
                try {
                    // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á Path: artifacts/my-education-app-56791/public/data/scores
                    const ref = collection(db, 'artifacts', appId, 'public', 'data', 'scores');
                    await addDoc(ref, { 
                        name: playerName, 
                        score, 
                        timestamp: serverTimestamp(),
                        uid: currentUser.uid 
                    });
                } catch (e) { console.error("Error saving score:", e); }
            }
        }

        function setupLeaderboard() {
            const ref = collection(db, 'artifacts', appId, 'public', 'data', 'scores');
            
            // ‡πÉ‡∏ä‡πâ onSnapshot ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Real-time updates
            onSnapshot(ref, (snap) => {
                updateStatus(true);
                const listLogin = document.getElementById('leaderboard-login');
                const listResult = document.getElementById('leaderboard-result');
                let rawData = [];
                snap.forEach(doc => rawData.push(doc.data()));
                
                // ‡∏Ñ‡∏±‡∏î‡∏Å‡∏£‡∏≠‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ñ‡∏ô
                const bestScores = {};
                rawData.forEach(r => {
                    if (!bestScores[r.name] || r.score > bestScores[r.name].score) bestScores[r.name] = r;
                });

                const sorted = Object.values(bestScores).sort((a, b) => b.score - a.score);
                
                const html = (data) => data.map((s, i) => `
                    <div class="flex justify-between items-center bg-white p-3 rounded-xl border border-emerald-100 shadow-sm update-flash">
                        <span class="font-bold text-emerald-800">#${i + 1} ${s.name}</span>
                        <span class="bg-emerald-600 text-white px-3 py-1 rounded-full font-bold text-sm">${s.score}</span>
                    </div>
                `).join('');

                if (sorted.length > 0) {
                    listLogin.innerHTML = html(sorted.slice(0, 5));
                    listResult.innerHTML = html(sorted.slice(0, 10));
                } else {
                    listLogin.innerHTML = '<p class="text-center text-gray-400 text-xs italic">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÉ‡∏Ñ‡∏£‡∏ó‡∏≥‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>';
                    listResult.innerHTML = '<p class="text-center text-gray-400 text-xs italic">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>';
                }
            }, (error) => {
                updateStatus(false);
                console.error("Leaderboard error:", error);
            });
        }

        function updateStatus(online) {
            const dot = document.getElementById('status-dot');
            const text = document.getElementById('status-text');
            const tag = document.getElementById('status-tag');
            if (online) {
                dot.className = "w-2 h-2 bg-red-500 rounded-full animate-pulse";
                text.innerText = "Live Online";
                tag.classList.replace('text-gray-400', 'text-emerald-600');
            } else {
                dot.className = "w-2 h-2 bg-gray-400 rounded-full";
                text.innerText = "Disconnected";
                tag.classList.replace('text-emerald-600', 'text-gray-400');
            }
        }

        document.getElementById('btn-start').onclick = startGame;
        document.getElementById('btn-recycle').onclick = () => checkAnswer('recycle');
        document.getElementById('btn-organic').onclick = () => checkAnswer('organic');
        document.getElementById('btn-hazard').onclick = () => checkAnswer('hazard');
        document.getElementById('btn-general').onclick = () => checkAnswer('general');

        window.onload = async () => {
            // ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£ Login ‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö
            try {
                await signInAnonymously(auth);
            } catch (e) { console.error("Anonymous login error:", e); }

            onAuthStateChanged(auth, user => {
                currentUser = user;
                if (user) setupLeaderboard();
            });
        };
    </script>
</body>
</html>
